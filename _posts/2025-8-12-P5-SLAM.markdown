---
layout: post
title: "P5-Autonomous-Mapping"
date: 2025-12-08 11:00:00 +0200
categories: service-robotics
---

# **Autonomous Mapping**

Este trabajo presenta un robot autónomo capaz de **explorar un entorno desconocido**, construir un mapa navegable en tiempo real y desplazarse hacia objetivos recién descubiertos usando **Breadth-First Search (BFS)**. El sistema combina percepción láser, construcción dinámica de mapas, navegación reactiva y evasión automática de obstáculos.

El objetivo es lograr un comportamiento completamente independiente, donde el robot identifica áreas transitables, evalúa seguridad, genera objetivos locales y se dirige hacia ellos evitando colisiones.

## **Objetivo General**

El robot opera sin puntos predefinidos ni mapas previos. Su misión consiste en:

- **Explorar el entorno mientras genera un mapa dinámico de obstáculos.**
- **Identificar regiones seguras alejadas del robot y desplazarse hacia ellas.**
- **Evitar colisiones y redirigir la ruta al detectar obstáculos.**
- **Actualizar el mapa y los objetivos de forma continua.**

Esto permite exploración libre y expansión progresiva del mapa sin supervisión.

## **Generación del Mapa**

El mapa se representa como una **matriz `numpy` de 8 bits**, donde cada celda almacena un valor de intensidad:

| Valor | Significado |
|---|---|
| `0` | obstáculo detectado |
| `>0` | espacio libre, más brillante = más observado |

Cada barrido del láser actualiza la matriz:

1. Cada rayo avanza en pasos discretos, aumentando la intensidad de celdas libres.  
2. Si se detecta un obstáculo, la celda se penaliza disminuyendo la intensidad.  
3. La actualización del mapa se realiza **solo cuando el robot se ha desplazado suficientemente** desde la última posición registrada, evitando recalcular innecesariamente zonas ya exploradas.  
4. La matriz se publica en **WebGUI**, permitiendo visualizar el mapa en tiempo real.

Se utiliza un **modelo logístico** (`inc()`) para actualizar las intensidades, limitando cambios extremos y evitando saturación.

## **Selección Inteligente de Objetivos**

El motor de navegación ejecuta un **BFS radial** desde la posición actual del robot. Busca una celda que cumpla:

✔ distancia mínima segura desde el robot  
✔ región libre alrededor del objetivo  
✔ trayectoria sin obstáculos desde el origen  

El BFS devuelve:

- un **mid target** para suavizar la trayectoria  
- un **final target** que expande óptimamente el frente de exploración  

Se priorizan celdas dentro de un rango de intensidad (`colors=[100,200]`) y áreas consideradas seguras por la función `is_safe()`.

## **Control de Movimiento**

El movimiento depende de la orientación relativa al objetivo:

- Si el error angular es alto → solo rotación  
- Si está alineado → se aplica velocidad hacia adelante  

Cuando se alcanza la mitad de la ruta, el objetivo cambia automáticamente al final target. Si el área objetivo se vuelve insegura, se descarta y BFS selecciona un nuevo destino.

## **Evasión Activa de Obstáculos**

Un módulo frontal garantiza la prevención de colisiones:

| Fase | Acción |
|---|---|
| 1 ~ rotación | giro en el lugar para abrir espacio |
| 2 ~ avance corto | desplazamiento lateral para escapar del obstáculo |
| 3 | retorno a modo navegación |

Los tiempos de cada fase (`avoid_f`, `avoid_s`) son parametrizables, ofreciendo adaptabilidad a distintos entornos.

## **Visualización**

La interfaz muestra:

- mapa completo actualizado en tiempo real  
- robot y objetivos resaltados  
- trayectoria de exploración y puntos procesados por BFS  

Esto permite monitorear fácilmente la exploración y entender cómo BFS guía la expansión espacial.

## **Video**

**SLAM INTENSITY**
<div style="display: flex; justify-content: center;">
  <iframe width="700" height="394" src="https://www.youtube.com/embed/9s7i0ycGTtQ" frameborder="0" allowfullscreen></iframe>
</div>

**SLAM PROBABILISTIC INTENSITY**

## **Conclusión**

Este robot establece una base robusta para exploración y vigilancia autónoma en entornos desconocidos. Sus capacidades incluyen:

- mapeo incremental con láser y reconstrucción continua  
- generación autónoma de objetivos mediante BFS  
- control reactivo basado en error angular  
- evasión inmediata de obstáculos cercanos  

El sistema es independiente de mapas previos o rutas predefinidas, siendo ligero, escalable y apto para exploración y búsqueda en entornos reales.
